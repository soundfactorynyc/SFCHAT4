<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Manage Subscription - Sound Factory NYC</title>
    <meta name="color-scheme" content="dark">
    <style>
        :root{--bg:#000000;--surface:#0a0a0a;--border:#333333;--text:#ffffff;--muted:#999999}
        *{box-sizing:border-box;margin:0;padding:0}
        html,body{height:100%}
        body{background:#000000;color:#ffffff;font-family:-apple-system,BlinkMacSystemFont,"SF Pro Text","Helvetica Neue",Helvetica,Arial,sans-serif;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:flex;flex-direction:column;min-height:100vh}
        .container{width:100%;max-width:480px;margin:0 auto;padding:20px;animation:fadeIn 0.6s ease}
        @keyframes fadeIn{from{opacity:0;transform:translateY(10px)}to{opacity:1;transform:translateY(0)}}
        .header{text-align:center;margin-bottom:40px}
        .logo-wrapper{margin:0 auto 20px;display:flex;justify-content:center;align-items:center;height:100px}
        .logo{height:80px;width:auto;object-fit:contain}
        .brand-text{font-size:11px;text-transform:uppercase;letter-spacing:2.5px;color:#999999;margin-bottom:8px;font-weight:700}
        h1{font-size:18px;font-weight:700;margin-bottom:8px;letter-spacing:0.3px;color:#F0F0F0;text-transform:uppercase}
        .subtitle{color:#999999;font-size:12px;line-height:16px;font-weight:400;letter-spacing:0.2px}
        .main-card{background:#0a0a0a;border:0.5px solid rgba(255,255,255,0.15);border-radius:2px;padding:32px 24px}
        .subscription-section{background:rgba(255,255,255,0.02);border:0.5px solid rgba(255,255,255,0.15);border-radius:2px;padding:24px;margin-bottom:24px}
        .subscription-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:16px;padding-bottom:16px;border-bottom:0.5px solid rgba(255,255,255,0.1)}
        .subscription-title{font-size:14px;font-weight:700;color:#F0F0F0;text-transform:uppercase;letter-spacing:1.25px}
        .status-badge{display:inline-block;padding:4px 12px;background:rgba(76,175,80,0.1);border:0.5px solid rgba(76,175,80,0.3);border-radius:2px;color:#4caf50;font-size:10px;font-weight:700;text-transform:uppercase;letter-spacing:1px}
        .subscription-details{display:grid;gap:12px}
        .detail-row{display:flex;justify-content:space-between;font-size:12px}
        .detail-label{color:#999999;letter-spacing:0.2px}
        .detail-value{color:#F0F0F0;font-weight:600}
        .divider{border-top:1px solid rgba(255,255,255,0.1);padding-top:16px;margin-bottom:16px}
        .divider-symbol{text-align:center;font-size:16px;color:rgba(255,255,255,0.3);margin-bottom:16px}
        .action-section{background:rgba(255,255,255,0.02);border:0.5px solid rgba(255,255,255,0.15);border-radius:2px;padding:16px;margin-bottom:12px;cursor:pointer;transition:all 0.2s}
        .action-section:hover{background:rgba(255,255,255,0.05);border-color:rgba(255,255,255,0.3)}
        .action-header{display:flex;justify-content:space-between;align-items:center;margin-bottom:8px}
        .action-icon{font-size:20px}
        .action-arrow{font-size:12px;color:#999}
        .action-title{font-size:12px;font-weight:700;color:#F0F0F0;text-transform:uppercase;letter-spacing:1px;margin-bottom:4px}
        .action-description{font-size:11px;color:#999999;line-height:14px;letter-spacing:0.2px}
        .btn{width:100%;padding:0;height:32px;border-radius:2px;background:#111111;color:#ffffff;border:1px solid #222222;font-size:11px;font-weight:700;cursor:pointer;transition:all 0.2s;text-transform:uppercase;letter-spacing:1.5px;margin-top:8px}
        .btn:hover:not(:disabled){background:#1a1a1a;border-color:#333333}
        .btn:disabled{opacity:0.3;cursor:not-allowed}
        .loading{display:inline-block;width:14px;height:14px;border:2px solid #fff;border-radius:50%;border-top-color:transparent;animation:spin 0.8s linear infinite;margin-right:8px}
        @keyframes spin{to{transform:rotate(360deg)}}
        .secure-badge{text-align:center;padding:16px 0;margin:16px 0;border-top:0.5px solid rgba(255,255,255,0.1)}
        .secure-badge-text{font-size:11px;color:#666;text-transform:uppercase;letter-spacing:2px;font-weight:700}
        .professional-footer{background:#0a0a0a;border-top:1px solid rgba(255,255,255,0.08);padding:20px 20px 16px;margin-top:auto}
        .footer-content{max-width:480px;margin:0 auto;text-align:center}
        .footer-company{font-size:11px;color:#999;margin-bottom:4px;letter-spacing:1.5px;font-weight:700;text-transform:uppercase}
        .footer-copyright{font-size:10px;color:#666;letter-spacing:0.2px}
        @media (max-width:480px){.container{padding:16px}.main-card{padding:24px 20px}}
    </style>
</head>
<body>
    <div class="container">
        <div class="header">
            <div class="logo-wrapper">
                <img src="sf-logo.png" alt="Sound Factory" class="logo" onerror="this.style.display='none'">
            </div>
            <div class="brand-text">SOUND FACTORY NYC</div>
            <h1>Manage Subscription</h1>
            <p class="subtitle">View & Update Your Account</p>
        </div>

        <div class="main-card">
            <div class="subscription-section">
                <div class="subscription-header">
                    <div class="subscription-title">Current Plan</div>
                    <span class="status-badge">Active</span>
                </div>

                <div class="subscription-details">
                    <div class="detail-row">
                        <span class="detail-label">Plan</span>
                        <span class="detail-value">Premium Plan</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Amount</span>
                        <span class="detail-value">$29.00/month</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Next Billing</span>
                        <span class="detail-value">Nov 15, 2024</span>
                    </div>
                    <div class="detail-row">
                        <span class="detail-label">Payment Method</span>
                        <span class="detail-value">‚Ä¢‚Ä¢‚Ä¢‚Ä¢ 4242</span>
                    </div>
                </div>
            </div>

            <div class="divider">
                <div class="divider-symbol">‚∏ª</div>
            </div>

            <div class="action-section" onclick="openPortal()">
                <div class="action-header">
                    <span class="action-icon">üí≥</span>
                    <span class="action-arrow">‚Üí</span>
                </div>
                <div class="action-title">Update Payment Method</div>
                <div class="action-description">
                    Change your credit card or add a new payment method
                </div>
            </div>

            <div class="action-section" onclick="openPortal()">
                <div class="action-header">
                    <span class="action-icon">üìÑ</span>
                    <span class="action-arrow">‚Üí</span>
                </div>
                <div class="action-title">View Invoices</div>
                <div class="action-description">
                    Access and download all your past invoices
                </div>
            </div>

            <div class="action-section" onclick="openPortal()">
                <div class="action-header">
                    <span class="action-icon">üîÑ</span>
                    <span class="action-arrow">‚Üí</span>
                </div>
                <div class="action-title">Change Plan</div>
                <div class="action-description">
                    Upgrade, downgrade, or modify your subscription
                </div>
            </div>

            <div class="action-section" onclick="openPortal()">
                <div class="action-header">
                    <span class="action-icon">‚ùå</span>
                    <span class="action-arrow">‚Üí</span>
                </div>
                <div class="action-title">Cancel Subscription</div>
                <div class="action-description">
                    Cancel your subscription at any time
                </div>
            </div>

            <div class="divider">
                <div class="divider-symbol">‚∏ª</div>
            </div>

            <button class="btn" id="portal-button">Open Billing Portal</button>

            <div class="secure-badge">
                <div class="secure-badge-text">Powered by Stripe Connect</div>
            </div>
        </div>
    </div>

    <footer class="professional-footer">
        <div class="footer-content">
            <div class="footer-company">SOUND FACTORY NYC</div>
            <div class="footer-copyright">¬© 2025 Sound Factory NYC. All rights reserved.</div>
        </div>
    </footer>

    <script>
        function openPortal(){document.getElementById('portal-button').click()}
        
        document.getElementById('portal-button').addEventListener('click',async()=>{
            const btn=document.getElementById('portal-button');
            const originalText=btn.innerHTML;
            
            try{
                btn.disabled=true;
                btn.innerHTML='<span class="loading"></span>Processing...';
                
                const response=await fetch('/.netlify/functions/create-portal-session',{
                    method:'POST',
                    headers:{'Content-Type':'application/json'},
                    body:JSON.stringify({customerId:'cus_xxx'})
                });

                const session=await response.json();

                if(session.url){
                    window.location.href=session.url;
                }else if(session.error){
                    alert('Error: '+session.error);
                    btn.disabled=false;
                    btn.innerHTML=originalText;
                }
            }catch(error){
                console.error('Error:',error);
                alert('An error occurred. Please try again.');
                btn.disabled=false;
                btn.innerHTML=originalText;
            }
        });
    </script>
</body>
</html>