
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                 RETURNING USER LOGIN                       â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

    ğŸ‘¤ USER                    ğŸŒ FRONTEND              ğŸ”§ BACKEND              ğŸ” STRIPE           ğŸ’¾ DATABASE
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Visit login page         â”‚                        â”‚                       â”‚                    â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Enter email only         â”‚                        â”‚                       â”‚                    â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Click "Continue"         â”‚  POST /stripe-login-  â”‚                       â”‚                    â”‚
      â”‚                           â”‚  with-email            â”‚                       â”‚                    â”‚
      â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Find promoter        â”‚                    â”‚
      â”‚                           â”‚                        â”‚  by email             â”‚                    â”‚
      â”‚                           â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚                           â”‚                        â”‚  Promoter found       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Validate status      â”‚                    â”‚
      â”‚                           â”‚                        â”‚  (must be approved)   â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Create AccountLink   â”‚                    â”‚
      â”‚                           â”‚                        â”‚  type: account_update â”‚                    â”‚
      â”‚                           â”‚                        â”‚  collect: currently_due                    â”‚
      â”‚                           â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
      â”‚                           â”‚  Return login URL      â”‚  Verification URL     â”‚                    â”‚
      â”‚                           â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Redirect to Stripe       â”‚                        â”‚                       â”‚                    â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
      â”‚  Stripe login page        â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Verify identity          â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
      â”‚  Send SMS code            â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Enter SMS code           â”‚                        â”‚                       â”‚                    â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
      â”‚  Redirect to callback     â”‚                        â”‚                       â”‚                    â”‚
      â”‚  with promoter_id         â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Load callback page       â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚  POST /stripe-login-  â”‚                       â”‚                    â”‚
      â”‚                           â”‚  verify                â”‚                       â”‚                    â”‚
      â”‚                           â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Get promoter data    â”‚                    â”‚
      â”‚                           â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
      â”‚                           â”‚                        â”‚  Promoter found       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Validate status      â”‚                    â”‚
      â”‚                           â”‚                        â”‚  (must be approved)   â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Verify Stripe        â”‚                    â”‚
      â”‚                           â”‚                        â”‚  account still active â”‚                    â”‚
      â”‚                           â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚
      â”‚                           â”‚                        â”‚  Account active       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Generate new session â”‚                    â”‚
      â”‚                           â”‚                        â”‚  token (32 bytes)     â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Expiry: +24 hours    â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚  Update database      â”‚                    â”‚
      â”‚                           â”‚                        â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
      â”‚                           â”‚                        â”‚  - session_token      â”‚                    â”‚
      â”‚                           â”‚                        â”‚  - session_expires_at â”‚                    â”‚
      â”‚                           â”‚                        â”‚  - last_login_at      â”‚                    â”‚
      â”‚                           â”‚                        â”‚  - stripe status      â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚  Return session data   â”‚                       â”‚                    â”‚
      â”‚                           â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Store in localStorage    â”‚                        â”‚                       â”‚                    â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚  Redirect to dashboard    â”‚                        â”‚                       â”‚                    â”‚
      â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
      â”‚  ğŸ‰ LOGGED IN!            â”‚                        â”‚                       â”‚                    â”‚
      â”‚                           â”‚                        â”‚                       â”‚                    â”‚
```

---

## ğŸ” SESSION MANAGEMENT

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                    SESSION LIFECYCLE                       â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

    ğŸ“± BROWSER                     ğŸ’¾ DATABASE                   â° TIME
      â”‚                               â”‚                            â”‚
      â”‚  Session Created              â”‚                            â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
      â”‚  localStorage.setItem()       â”‚  INSERT session_token      â”‚
      â”‚                               â”‚  session_expires_at        â”‚
      â”‚                               â”‚  (+24 hours)               â”‚
      â”‚                               â”‚                            â”‚
      â”‚                               â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
      â”‚                               â”‚                            â”‚  Hour 1
      â”‚  Using dashboard              â”‚                            â”‚  Hour 2
      â”‚  Reading session from         â”‚                            â”‚  ...
      â”‚  localStorage                 â”‚                            â”‚  Hour 23
      â”‚                               â”‚                            â”‚
      â”‚                               â”‚                            â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>
      â”‚                               â”‚                            â”‚  Hour 24
      â”‚  Session Expired!             â”‚                            â”‚  EXPIRED!
      â”‚  Clear localStorage           â”‚                            â”‚
      â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
      â”‚  Redirect to login            â”‚  session_expires_at        â”‚
      â”‚                               â”‚  < NOW()                   â”‚
      â”‚                               â”‚                            â”‚
```

---

## ğŸ›¡ï¸ ERROR HANDLING FLOW

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                   ERROR SCENARIOS                          â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

LOGIN ATTEMPT
    â”‚
    â”œâ”€â”€> Email not found â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> "No account found. Please sign up."
    â”‚
    â”œâ”€â”€> Account pending â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> "Your account is pending approval."
    â”‚
    â”œâ”€â”€> Account rejected â”€â”€â”€â”€â”€â”€â”€â”€â”€> "Your account is rejected. Contact support."
    â”‚
    â”œâ”€â”€> Account suspended â”€â”€â”€â”€â”€â”€â”€â”€> "Your account is suspended. Contact support."
    â”‚
    â”œâ”€â”€> Stripe account missing â”€â”€â”€> "Stripe account not found. Contact support."
    â”‚
    â”œâ”€â”€> Stripe API error â”€â”€â”€â”€â”€â”€â”€â”€â”€> "Unable to verify account. Try again."
    â”‚
    â”œâ”€â”€> User cancels flow â”€â”€â”€â”€â”€â”€â”€â”€> "Login cancelled. Please try again."
    â”‚
    â”œâ”€â”€> Session expired â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> "Session expired. Please try again."
    â”‚
    â””â”€â”€> Success â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€> Redirect to dashboard âœ…

```

---

## ğŸ“Š DATA FLOW DIAGRAM

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                 DATA TRANSFORMATIONS                       â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

USER INPUT                   BACKEND PROCESSING              DATABASE STORAGE
    â”‚                               â”‚                            â”‚
    â”‚  email@example.com           â”‚                            â”‚
    â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                            â”‚
    â”‚                               â”‚  Normalize:               â”‚
    â”‚                               â”‚  - toLowerCase()          â”‚
    â”‚                               â”‚  - trim()                 â”‚
    â”‚                               â”‚                            â”‚
    â”‚                               â”‚  Query:                   â”‚
    â”‚                               â”‚  WHERE email =            â”‚
    â”‚                               â”‚  'email@example.com'      â”‚
    â”‚                               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                               â”‚                            â”‚
    â”‚                               â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
    â”‚                               â”‚  promoter_record          â”‚
    â”‚                               â”‚                            â”‚
    â”‚                               â”‚  Generate:                â”‚
    â”‚                               â”‚  token = randomBytes(32)  â”‚
    â”‚                               â”‚  .toString('hex')         â”‚
    â”‚                               â”‚  // 64 characters         â”‚
    â”‚                               â”‚                            â”‚
    â”‚                               â”‚  Calculate:               â”‚
    â”‚                               â”‚  expires = new Date()     â”‚
    â”‚                               â”‚  expires.setHours(+24)    â”‚
    â”‚                               â”‚                            â”‚
    â”‚                               â”‚  Update:                  â”‚
    â”‚                               â”‚  SET session_token        â”‚
    â”‚                               â”‚  SET session_expires_at   â”‚
    â”‚                               â”‚  SET last_login_at        â”‚
    â”‚                               â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
    â”‚                               â”‚                            â”‚
    â”‚                               â”‚  Return:                  â”‚
    â”‚                               â”‚  {                        â”‚
    â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤    token,                 â”‚
    â”‚  localStorage.setItem(        â”‚    promoter,              â”‚
    â”‚    'promoter_session',        â”‚    expiresAt              â”‚
    â”‚    JSON.stringify(data)       â”‚  }                        â”‚
    â”‚  )                            â”‚                            â”‚
    â”‚                               â”‚                            â”‚
```

---

## ğŸ”„ STRIPE ACCOUNTLINK TYPES

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ              STRIPE ACCOUNTLINK USAGE                      â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

SIGNUP (New User)
    â”‚
    â””â”€â”€> AccountLink
         â”œâ”€ type: 'account_onboarding'
         â”œâ”€ Purpose: Complete account setup
         â”œâ”€ Includes: KYC, phone verification, banking
         â””â”€ Result: Fully onboarded Stripe account

LOGIN (Returning User)  
    â”‚
    â””â”€â”€> AccountLink
         â”œâ”€ type: 'account_update'
         â”œâ”€ collect: 'currently_due'
         â”œâ”€ Purpose: Verify identity via SMS
         â”œâ”€ Includes: Phone verification
         â””â”€ Result: Authenticated user session
```

---

## ğŸ“± MOBILE FLOW

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                  MOBILE USER EXPERIENCE                    â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

ğŸ“± PHONE              ğŸŒ WEBSITE           ğŸ“§ SMS             âœ… RESULT
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Open login page    â”‚                    â”‚                  â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Enter email        â”‚                    â”‚                  â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Tap "Continue"     â”‚                    â”‚                  â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Redirect to Stripe â”‚                    â”‚                  â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Loading...         â”‚                    â”‚                  â”‚
   â”‚                     â”‚  Send SMS          â”‚                  â”‚
   â”‚                     â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                  â”‚
   â”‚  ğŸ“© "Your code: 123456"                 â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Enter code         â”‚                    â”‚                  â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚                    â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  âœ… Verified!       â”‚                    â”‚                  â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Redirect back      â”‚                    â”‚                  â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Show success       â”‚                    â”‚                  â”‚
   â”‚  "Welcome Back!"    â”‚                    â”‚                  â”‚
   â”‚<â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤                    â”‚                  â”‚
   â”‚                     â”‚                    â”‚                  â”‚
   â”‚  Auto-redirect to   â”‚                    â”‚                  â”‚
   â”‚  Dashboard          â”‚                    â”‚                  â”‚
   â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€>â”‚
   â”‚                     â”‚                    â”‚  ğŸ‰ Logged In!   â”‚
   â”‚                     â”‚                    â”‚                  â”‚
```

---

## ğŸ¯ KEY DECISION POINTS

```
â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”“
â”ƒ                 SYSTEM DECISION LOGIC                      â”ƒ
â”—â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”â”›

When user submits email:
  â”œâ”€ Email exists in database?
  â”‚  â”œâ”€ YES â†’ Continue to status check
  â”‚  â””â”€ NO  â†’ Error: "No account found. Please sign up."
  â”‚
  â””â”€ If email exists:
     â”œâ”€ Status == 'approved'?
     â”‚  â”œâ”€ YES â†’ Generate login link
     â”‚  â””â”€ NO  â†’ Error: "Account is {status}"
     â”‚
     â””â”€ If approved:
        â”œâ”€ Stripe account exists?
        â”‚  â”œâ”€ YES â†’ Create AccountLink
        â”‚  â””â”€ NO  â†’ Error: "Stripe account not found"
        â”‚
        â””â”€ AccountLink created:
           â””â”€ Redirect user to Stripe âœ…

After Stripe verification:
  â”œâ”€ Promoter ID in URL?
  â”‚  â”œâ”€ YES â†’ Continue to session creation
  â”‚  â””â”€ NO  â†’ Error: "Missing information"
  â”‚
  â””â”€ If promoter ID exists:
     â”œâ”€ Promoter still approved?
     â”‚  â”œâ”€ YES â†’ Generate session
     â”‚  â””â”€ NO  â†’ Error: "Account status changed"
     â”‚
     â””â”€ If approved:
        â”œâ”€ Create session token
        â”œâ”€ Set 24-hour expiry
        â”œâ”€ Update database
        â”œâ”€ Return session data
        â””â”€ Store in localStorage âœ…
```

---

**Visual Flow Diagrams Complete!** ğŸ“Š

These diagrams show:
- âœ… Complete signup flow with all steps
- âœ… Complete login flow with SMS verification
- âœ… Session lifecycle and expiration
- âœ… Error handling for all scenarios
- âœ… Data transformations and storage
- âœ… Mobile-friendly SMS flow
- âœ… Decision logic at each step

Use these diagrams for:
- Understanding the system architecture
- Debugging issues
- Training new developers
- Explaining to stakeholders
- Technical documentation
