<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <title>Sound Factory NYC</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            -webkit-tap-highlight-color: transparent;
        }
        
        html, body {
            background: #000;
            color: #fff;
            font-family: -apple-system, BlinkMacSystemFont, system-ui, sans-serif;
            overflow: hidden;
            height: 100vh;
            height: 100dvh;
            width: 100vw;
            position: fixed;
        }
        
        .blueprint-bg {
            position: fixed;
            inset: 0;
            background: 
                linear-gradient(rgba(255,255,255,0.03) 1px, transparent 1px),
                linear-gradient(90deg, rgba(255,255,255,0.03) 1px, transparent 1px);
            background-size: 20px 20px;
            z-index: 1;
        }
        
        #reaction-canvas {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            pointer-events: none;
            z-index: 999;
        }
        
        .header {
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            height: 50px;
            background: rgba(0,0,0,0.9);
            backdrop-filter: blur(20px);
            border-bottom: 1px solid rgba(255,255,255,0.1);
            z-index: 900;
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0 15px;
        }
        
        .logo {
            font-size: 14px;
            font-weight: 700;
            letter-spacing: 0.5px;
        }
        
        .stats {
            display: flex;
            gap: 12px;
            font-size: 10px;
            font-weight: 600;
            color: rgba(255,255,255,0.6);
        }
        
        .stat-value {
            color: #fff;
            font-weight: 700;
        }
        
        .blueprint-area {
            position: fixed;
            top: 50px;
            bottom: 0;
            left: 0;
            right: 0;
            z-index: 10;
            display: flex;
            align-items: center;
            justify-content: center;
            padding: 0 3px;
        }
        
        svg {
            width: 100%;
            height: 100%;
            display: block;
        }
        
        .character {
            position: absolute;
            width: 20px;
            height: 20px;
            background: linear-gradient(135deg, #ff0066, #ff3399);
            border-radius: 50%;
            font-size: 7px;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            box-shadow: 0 0 15px rgba(255,0,102,0.6);
            z-index: 100;
            left: 50%;
            top: 50%;
            transform: translate(-50%, -50%);
            cursor: move;
            touch-action: none;
        }
        
        /* DRAWER BARS */
        .drawer-bar {
            position: fixed;
            height: 88px;
            background: rgba(255,255,255,0.08);
            border: 1px solid rgba(255,255,255,0.15);
            border-radius: 12px;
            z-index: 800;
            transition: all 0.3s cubic-bezier(0.4, 0, 0.2, 1);
            overflow: hidden;
            display: flex;
            align-items: center;
        }
        
        /* Chat Bar - Bottom Right */
        .drawer-bar.chat {
            right: 0;
            bottom: 20px;
            width: 60px;
            border-right: none;
            border-radius: 12px 0 0 12px;
        }
        
        .drawer-bar.chat.open {
            width: 90vw;
            max-width: 600px;
        }
        
        /* Money Bar - Bottom Right (above chat) */
        .drawer-bar.money {
            right: 0;
            bottom: 120px;
            width: 60px;
            border-right: none;
            border-radius: 12px 0 0 12px;
        }
        
        .drawer-bar.money.open {
            width: 90vw;
            max-width: 600px;
        }
        
        /* Reactions Bar - Bottom Left */
        .drawer-bar.reactions {
            left: 0;
            bottom: 20px;
            width: 60px;
            border-left: none;
            border-radius: 0 12px 12px 0;
        }
        
        .drawer-bar.reactions.open {
            width: 90vw;
            max-width: 600px;
        }
        
        /* Social Bar - Bottom Left (above reactions) */
        .drawer-bar.social {
            left: 0;
            bottom: 120px;
            width: 60px;
            border-left: none;
            border-radius: 0 12px 12px 0;
        }
        
        .drawer-bar.social.open {
            width: 90vw;
            max-width: 600px;
        }
        
        .drawer-trigger {
            position: absolute;
            top: 0;
            width: 60px;
            height: 88px;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            z-index: 2;
        }
        
        .drawer-bar.chat .drawer-trigger,
        .drawer-bar.money .drawer-trigger {
            right: 0;
        }
        
        .drawer-bar.reactions .drawer-trigger,
        .drawer-bar.social .drawer-trigger {
            left: 0;
        }
        
        .drawer-icon {
            width: 16px;
            height: 3px;
            background: rgba(255,255,255,0.4);
            position: relative;
        }
        
        .drawer-icon::before,
        .drawer-icon::after {
            content: '';
            position: absolute;
            width: 16px;
            height: 3px;
            background: rgba(255,255,255,0.4);
            left: 0;
        }
        
        .drawer-icon::before { top: -6px; }
        .drawer-icon::after { top: 6px; }
        
        .drawer-bar.open .drawer-trigger {
            pointer-events: none;
        }
        
        .drawer-content {
            opacity: 0;
            width: 100%;
            height: 100%;
            padding: 0 6px;
            display: flex;
            align-items: center;
            gap: 4px;
            transition: opacity 0.2s;
            pointer-events: none;
        }
        
        .drawer-bar.open .drawer-content {
            opacity: 1;
            transition-delay: 0.15s;
            pointer-events: all;
        }
        
        .chat-input {
            flex: 1;
            padding: 6px 10px;
            background: rgba(255,255,255,0.06);
            border: 0.5px solid rgba(255,255,255,0.15);
            border-radius: 8px;
            color: #fff;
            font-size: 11px;
            font-family: -apple-system, BlinkMacSystemFont, 'SF Pro Text', system-ui, sans-serif;
            outline: none;
            letter-spacing: -0.01em;
        }
        
        .chat-input::placeholder {
            color: rgba(255,255,255,0.4);
        }
        
        .btn-action {
            padding: 12px 16px;
            background: rgba(255,255,255,0.06);
            border: 0.5px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: #fff;
            font-size: 16px;
            font-weight: 590;
            cursor: pointer;
            white-space: nowrap;
            transition: all 0.15s;
            text-transform: uppercase;
            letter-spacing: 0.05em;
        }
        
        .btn-action:hover {
            background: rgba(255,255,255,0.12);
            border-color: rgba(255,255,255,0.2);
        }
        
        .btn-action:active {
            transform: scale(0.96);
        }
        
        .btn-close {
            padding: 0;
            width: 26px;
            height: 26px;
            background: rgba(255,255,255,0.06);
            border: 0.5px solid rgba(255,255,255,0.1);
            border-radius: 6px;
            color: rgba(255,255,255,0.6);
            font-size: 16px;
            font-weight: 300;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            line-height: 1;
            flex-shrink: 0;
            transition: all 0.15s;
        }
        
        .btn-close:hover {
            background: rgba(255,255,255,0.12);
            color: #fff;
        }
        
        .btn-close:active {
            transform: scale(0.96);
        }
        
        /* MODAL - iOS style */
        .modal {
            display: none;
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.85);
            backdrop-filter: blur(20px);
            z-index: 1000;
            align-items: center;
            justify-content: center;
            padding: 20px;
        }
        
        .modal.active {
            display: flex;
        }
        
        .modal-content {
            background: rgba(10,10,10,0.95);
            border: 0.5px solid rgba(255,255,255,0.2);
            border-radius: 12px;
            padding: 20px;
            max-width: 600px;
            width: 100%;
            max-height: 80vh;
            overflow-y: auto;
            position: relative;
        }
        
        .modal-header {
            font-size: 13px;
            font-weight: 700;
            margin-bottom: 15px;
            letter-spacing: -0.01em;
            padding-bottom: 10px;
            border-bottom: 0.5px solid rgba(255,255,255,0.1);
        }
        
        .modal-close {
            position: absolute;
            top: 15px;
            right: 15px;
            background: none;
            border: none;
            color: rgba(255,255,255,0.6);
            font-size: 20px;
            cursor: pointer;
            width: 28px;
            height: 28px;
            display: flex;
            align-items: center;
            justify-content: center;
            border-radius: 50%;
        }
        
        .modal-close:hover {
            background: rgba(255,255,255,0.08);
            color: #fff;
        }
        
        /* GRID - Ultra compact iOS style */
        .option-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(70px, 1fr));
            gap: 6px;
            margin-top: 15px;
        }
        
        .option-item {
            background: rgba(255,255,255,0.06);
            border: 0.5px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 12px 8px;
            text-align: center;
            cursor: pointer;
            transition: all 0.15s;
        }
        
        .option-item:hover {
            background: rgba(255,255,255,0.12);
            border-color: rgba(255,255,255,0.2);
        }
        
        .option-item.selected {
            background: #fff;
            border-color: #fff;
        }
        
        .option-label {
            font-size: 9px;
            font-weight: 590;
            letter-spacing: -0.01em;
            color: #fff;
            text-transform: uppercase;
        }
        
        .option-item.selected .option-label {
            color: #000;
        }
    </style>
</head>
<body>
    <div class="blueprint-bg"></div>
    <canvas id="reaction-canvas"></canvas>
    
    <div class="header">
        <div class="logo">SOUND FACTORY</div>
        <div class="stats">
            <span><span class="stat-value" id="onlineCount">842</span> ONLINE</span>
            <span><span class="stat-value" id="pinCount">3</span>/3 PINS</span>
            <span>$<span class="stat-value" id="tippedAmount">47</span> TIPPED</span>
        </div>
    </div>
    
    <div class="blueprint-area">
        <svg viewBox="0 0 400 520" preserveAspectRatio="none">
            <rect width="400" height="520" fill="none" stroke="rgba(255,255,255,0.1)" stroke-width="1"/>
            <rect x="30" y="30" width="340" height="460" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>
            <rect x="30" y="420" width="70" height="70" fill="none" stroke="rgba(255,0,102,0.3)" stroke-width="1"/>
            <text x="65" y="460" font-size="8" fill="rgba(255,0,102,0.6)" text-anchor="middle">DJ</text>
            <rect x="30" y="120" width="40" height="280" fill="none" stroke="rgba(255,255,255,0.2)" stroke-width="1"/>
            <rect x="120" y="80" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="215" y="80" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="310" y="80" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="120" y="160" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="215" y="160" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="310" y="160" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="120" y="240" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="215" y="240" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="310" y="240" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="120" y="320" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="215" y="320" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="310" y="320" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="120" y="400" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="215" y="400" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <rect x="310" y="400" width="30" height="30" fill="none" stroke="rgba(255,255,255,0.15)" stroke-width="1"/>
            <text x="200" y="20" font-size="9" fill="rgba(255,255,255,0.4)" text-anchor="middle">MAIN FLOOR</text>
        </svg>
        <div class="character" id="character">YOU</div>
    </div>
    
    <!-- CHAT BAR - Bottom Right -->
    <div class="drawer-bar chat" id="chatBar">
        <div class="drawer-trigger" onclick="toggleBar('chatBar')">
            <div class="drawer-icon"></div>
        </div>
        <div class="drawer-content">
            <input type="text" class="chat-input" id="chatInput" placeholder="Message...">
            <button class="btn-action" onclick="sendMessage()">Send</button>
            <button class="btn-close" onclick="closeBar('chatBar')">√ó</button>
        </div>
    </div>
    
    <!-- MONEY BAR - Bottom Right (above chat) -->
    <div class="drawer-bar money" id="moneyBar">
        <div class="drawer-trigger" onclick="toggleBar('moneyBar')">
            <div class="drawer-icon"></div>
        </div>
        <div class="drawer-content">
            <button class="btn-action" onclick="shootMoney(1)">$1</button>
            <button class="btn-action" onclick="shootMoney(5)">$5</button>
            <button class="btn-action" onclick="shootMoney(10)">$10</button>
            <button class="btn-action" onclick="shootMoney(20)">$20</button>
            <button class="btn-close" onclick="closeBar('moneyBar')">√ó</button>
        </div>
    </div>
    
    <!-- REACTIONS BAR - Bottom Left -->
    <div class="drawer-bar reactions" id="reactionsBar">
        <div class="drawer-trigger" onclick="toggleBar('reactionsBar')">
            <div class="drawer-icon"></div>
        </div>
        <div class="drawer-content">
            <button class="btn-close" onclick="closeBar('reactionsBar')">√ó</button>
            <button class="btn-action" onclick="shootReaction('‚ù§Ô∏è')">‚ù§Ô∏è</button>
            <button class="btn-action" onclick="shootReaction('üî•')">üî•</button>
            <button class="btn-action" onclick="shootReaction('üòÇ')">üòÇ</button>
            <button class="btn-action" onclick="shootReaction('üéâ')">üéâ</button>
            <button class="btn-action" onclick="shootReaction('üë†')">üë†</button>
        </div>
    </div>
    
    <!-- SOCIAL BAR - Bottom Left (above reactions) -->
    <div class="drawer-bar social" id="socialBar">
        <div class="drawer-trigger" onclick="toggleBar('socialBar')">
            <div class="drawer-icon"></div>
        </div>
        <div class="drawer-content">
            <button class="btn-close" onclick="closeBar('socialBar')">√ó</button>
            <button class="btn-action" onclick="openModal('social')">SOCIAL</button>
            <button class="btn-action" onclick="openModal('effects')">EFFECTS</button>
            <button class="btn-action" onclick="openModal('ai')">AI CHAIN</button>
            <button class="btn-action" onclick="openModal('pins')">PIN</button>
        </div>
    </div>
    
    <!-- MODAL -->
    <div class="modal" id="modal">
        <div class="modal-content">
            <button class="modal-close" onclick="closeModal()">√ó</button>
            <div class="modal-header" id="modalTitle">Options</div>
            <div id="modalBody"></div>
        </div>
    </div>
    
    <script>
        let openBarId = null;
        
        function toggleBar(id) {
            const bar = document.getElementById(id);
            
            if (openBarId && openBarId !== id) {
                closeBar(openBarId);
            }
            
            if (bar.classList.contains('open')) {
                closeBar(id);
            } else {
                bar.classList.add('open');
                openBarId = id;
            }
        }
        
        function closeBar(id) {
            document.getElementById(id).classList.remove('open');
            if (openBarId === id) openBarId = null;
        }
        
        // Modal System
        function openModal(type) {
            const modal = document.getElementById('modal');
            const title = document.getElementById('modalTitle');
            const body = document.getElementById('modalBody');
            
            modal.classList.add('active');
            
            switch(type) {
                case 'social':
                    title.textContent = 'SOCIAL MEDIA';
                    body.innerHTML = generateGrid([
                        'TIKTOK', 'INSTAGRAM', 'FACEBOOK', 'TWITTER',
                        'YOUTUBE', 'LINKEDIN', 'SNAPCHAT', 'SPOTIFY'
                    ]);
                    break;
                case 'effects':
                    title.textContent = 'CAMERA EFFECTS';
                    body.innerHTML = generateGrid([
                        'YOUNGER', 'SMOOTH', 'GLOW', 'GLAMOUR', 'VINTAGE', 'NEON',
                        'BW', 'WARM', 'COOL', 'DREAMY', 'SHARP', 'SOFT',
                        'DRAMATIC', 'SUNSET', 'DISCO', 'SPARKLE', 'HALO', 'STAR',
                        'BLUR BG', 'BOKEH', 'VHS', '80S', '90S', 'Y2K',
                        'GLITCH', 'MIRROR', 'KALEIDO', 'RAINBOW', 'GOLD', 'SILVER',
                        'FILM', 'DUAL CAM'
                    ]);
                    break;
                case 'ai':
                    title.textContent = 'AI VOCAL PERSONALITY';
                    body.innerHTML = generateGrid([
                        'HAPPY', 'SARCASM', 'DRAMATIC', 'CHILL', 'FANCY', 'HYPE',
                        'POET', 'ROBOT', 'GEN Z', 'ALIEN', 'DEEP', 'SOFT',
                        'VALLEY', 'NYC', 'SOUTHERN', 'BRITISH', 'SEDUCTIVE', 'FAST',
                        'SLOW', 'WHISPER', 'LOUD', 'RASPY', 'SMOOTH', 'ECHO'
                    ]);
                    break;
                case 'pins':
                    title.textContent = 'DROP A PIN';
                    body.innerHTML = `
                        <div style="margin-top: 15px;">
                            <input type="text" placeholder="Pin title..." style="
                                width: 100%;
                                background: rgba(255,255,255,0.06);
                                border: 0.5px solid rgba(255,255,255,0.15);
                                border-radius: 8px;
                                padding: 10px 12px;
                                font-size: 11px;
                                color: #fff;
                                font-family: inherit;
                                margin-bottom: 10px;
                            ">
                            <textarea placeholder="Add a message..." style="
                                width: 100%;
                                height: 80px;
                                background: rgba(255,255,255,0.06);
                                border: 0.5px solid rgba(255,255,255,0.15);
                                border-radius: 8px;
                                padding: 10px 12px;
                                font-size: 11px;
                                color: #fff;
                                font-family: inherit;
                                resize: vertical;
                                margin-bottom: 10px;
                            "></textarea>
                            <input type="url" placeholder="Table/Ticket Link (optional)..." style="
                                width: 100%;
                                background: rgba(255,255,255,0.06);
                                border: 0.5px solid rgba(255,255,255,0.15);
                                border-radius: 8px;
                                padding: 10px 12px;
                                font-size: 11px;
                                color: #fff;
                                font-family: inherit;
                                margin-bottom: 10px;
                            ">
                            <button class="btn-action" style="width: 100%; margin-top: 10px; padding: 12px; background: #fff; color: #000;">
                                DROP PIN
                            </button>
                        </div>
                    `;
                    break;
            }
        }
        
        function closeModal() {
            document.getElementById('modal').classList.remove('active');
        }
        
        function generateGrid(items) {
            return `
                <div class="option-grid">
                    ${items.map(item => `
                        <div class="option-item" onclick="this.classList.toggle('selected')">
                            <div class="option-label">${item}</div>
                        </div>
                    `).join('')}
                </div>
            `;
        }
        
        function sendMessage() {
            const input = document.getElementById('chatInput');
            if (input.value.trim()) {
                console.log('Message:', input.value);
                input.value = '';
            }
        }
        
        function shootReaction(emoji) {
            const x = Math.random() * window.innerWidth;
            const y = window.innerHeight - 50;
            window.reactionSystem.triggerReaction('emoji', { x, y, emoji, emojiType: emoji });
        }
        
        function shootMoney(amount) {
            const current = parseInt(document.getElementById('tippedAmount').textContent);
            document.getElementById('tippedAmount').textContent = current + amount;
            
            const x = Math.random() * window.innerWidth;
            const y = window.innerHeight - 50;
            window.reactionSystem.triggerReaction('money', { x, y, amount });
        }
        
        document.getElementById('chatInput').addEventListener('keypress', (e) => {
            if (e.key === 'Enter') sendMessage();
        });
        
        const char = document.getElementById('character');
        let isDragging = false;
        
        char.addEventListener('mousedown', () => isDragging = true);
        char.addEventListener('touchstart', (e) => {
            isDragging = true;
            e.preventDefault();
        });
        
        document.addEventListener('mouseup', () => isDragging = false);
        document.addEventListener('touchend', () => isDragging = false);
        
        document.addEventListener('mousemove', (e) => {
            if (isDragging) {
                char.style.left = e.clientX + 'px';
                char.style.top = e.clientY + 'px';
            }
        });
        
        document.addEventListener('touchmove', (e) => {
            if (isDragging && e.touches[0]) {
                char.style.left = e.touches[0].clientX + 'px';
                char.style.top = e.touches[0].clientY + 'px';
                e.preventDefault();
            }
        });
        
        // REACTION SYSTEM
        class ReactionSystem {
            constructor(canvasId) {
                this.canvas = document.getElementById(canvasId);
                this.ctx = this.canvas.getContext('2d');
                this.reactions = [];
                this.particles = [];
                this.scaleFactor = 0.6;
                this.init();
            }

            init() {
                this.resizeCanvas();
                window.addEventListener('resize', () => this.resizeCanvas());
                this.animate();
            }

            resizeCanvas() {
                this.canvas.width = window.innerWidth;
                this.canvas.height = window.innerHeight;
            }

            triggerReaction(type, data = {}) {
                const startX = data.x || window.innerWidth / 2;
                const startY = data.y || window.innerHeight - 100;

                switch(type) {
                    case 'money':
                        this.createMoneyReaction(startX, startY, data.amount || 1);
                        break;
                    case 'emoji':
                        this.createEmojiReaction(startX, startY, data.emoji || '‚ù§Ô∏è', data.emojiType || 'love');
                        break;
                }
            }

            createEmojiReaction(x, y, emoji, type) {
                const reaction = {
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 10,
                    vy: -20 - Math.random() * 10,
                    emoji: emoji,
                    type: type,
                    size: 30 * this.scaleFactor,
                    opacity: 1,
                    gravity: 0.5
                };
                this.reactions.push(reaction);

                for (let i = 0; i < 5; i++) {
                    this.particles.push({
                        x: x,
                        y: y,
                        vx: (Math.random() - 0.5) * 5,
                        vy: (Math.random() - 0.5) * 5,
                        size: Math.random() * 3 + 1,
                        color: this.getReactionColor(type),
                        life: 1,
                        decay: 0.02
                    });
                }
            }

            createMoneyReaction(x, y, amount) {
                const reaction = {
                    x: x,
                    y: y,
                    vx: (Math.random() - 0.5) * 8,
                    vy: -25 - Math.random() * 10,
                    amount: amount,
                    type: 'money',
                    size: 40 * this.scaleFactor,
                    opacity: 1,
                    rotation: 0,
                    rotationSpeed: (Math.random() - 0.5) * 0.3,
                    gravity: 0.6
                };
                this.reactions.push(reaction);

                for (let i = 0; i < 10; i++) {
                    this.particles.push({
                        x: x,
                        y: y,
                        vx: (Math.random() - 0.5) * 10,
                        vy: (Math.random() - 0.5) * 10,
                        size: Math.random() * 4 + 2,
                        color: '#FFD700',
                        life: 1,
                        decay: 0.015,
                        sparkle: true
                    });
                }
            }

            getReactionColor(type) {
                const colors = {
                    love: '#ff006e',
                    fire: '#ff6b35',
                    laugh: '#ffbe0b',
                    party: '#8338ec'
                };
                return colors[type] || '#ffffff';
            }

            draw() {
                this.ctx.clearRect(0, 0, this.canvas.width, this.canvas.height);

                for (let i = this.particles.length - 1; i >= 0; i--) {
                    const particle = this.particles[i];
                    
                    if (particle.life <= 0) {
                        this.particles.splice(i, 1);
                        continue;
                    }

                    this.ctx.save();
                    this.ctx.globalAlpha = particle.life;
                    
                    if (particle.sparkle) {
                        const sparkleSize = particle.size * (1 + Math.sin(Date.now() * 0.01) * 0.3);
                        this.ctx.fillStyle = particle.color;
                        this.drawStar(particle.x, particle.y, 4, sparkleSize, sparkleSize / 2);
                    } else {
                        this.ctx.beginPath();
                        this.ctx.arc(particle.x, particle.y, particle.size, 0, Math.PI * 2);
                        this.ctx.fillStyle = particle.color;
                        this.ctx.fill();
                    }
                    
                    this.ctx.restore();

                    particle.x += particle.vx;
                    particle.y += particle.vy;
                    particle.vy += 0.3;
                    particle.life -= particle.decay;
                }

                for (let i = this.reactions.length - 1; i >= 0; i--) {
                    const reaction = this.reactions[i];
                    
                    if (reaction.opacity <= 0 || reaction.y > this.canvas.height) {
                        this.reactions.splice(i, 1);
                        continue;
                    }

                    this.ctx.save();
                    this.ctx.translate(reaction.x, reaction.y);
                    this.ctx.rotate(reaction.rotation || 0);
                    this.ctx.globalAlpha = reaction.opacity;

                    if (reaction.type === 'money') {
                        const gradient = this.ctx.createLinearGradient(-reaction.size/2, 0, reaction.size/2, 0);
                        gradient.addColorStop(0, '#85bb65');
                        gradient.addColorStop(0.5, '#a5d6a7');
                        gradient.addColorStop(1, '#85bb65');
                        
                        this.ctx.fillStyle = gradient;
                        this.ctx.fillRect(-reaction.size/2, -reaction.size/4, reaction.size, reaction.size/2);
                        
                        this.ctx.fillStyle = '#2a5434';
                        this.ctx.font = `bold ${reaction.size/3}px Arial`;
                        this.ctx.textAlign = 'center';
                        this.ctx.textBaseline = 'middle';
                        this.ctx.fillText(`$${reaction.amount}`, 0, 0);
                        
                        reaction.rotation += reaction.rotationSpeed;
                    } else {
                        this.ctx.font = `${reaction.size}px Arial`;
                        this.ctx.textAlign = 'center';
                        this.ctx.textBaseline = 'middle';
                        this.ctx.fillText(reaction.emoji, 0, 0);
                    }

                    this.ctx.restore();

                    reaction.x += reaction.vx;
                    reaction.y += reaction.vy;
                    reaction.vy += reaction.gravity;
                    reaction.vx *= 0.99;
                    
                    if (reaction.y < reaction.size) {
                        reaction.vy = Math.abs(reaction.vy) * 0.5;
                    }
                    
                    if (reaction.x < reaction.size || reaction.x > this.canvas.width - reaction.size) {
                        reaction.vx = -reaction.vx * 0.8;
                    }
                }
            }

            drawStar(x, y, spikes, outerRadius, innerRadius) {
                let rot = Math.PI / 2 * 3;
                let step = Math.PI / spikes;

                this.ctx.beginPath();
                this.ctx.moveTo(x, y - outerRadius);

                for (let i = 0; i < spikes; i++) {
                    this.ctx.lineTo(x + Math.cos(rot) * outerRadius, y + Math.sin(rot) * outerRadius);
                    rot += step;
                    this.ctx.lineTo(x + Math.cos(rot) * innerRadius, y + Math.sin(rot) * innerRadius);
                    rot += step;
                }

                this.ctx.lineTo(x, y - outerRadius);
                this.ctx.closePath();
                this.ctx.fill();
            }

            animate() {
                this.draw();
                requestAnimationFrame(() => this.animate());
            }
        }

        const reactionSystem = new ReactionSystem('reaction-canvas');
        window.reactionSystem = reactionSystem;
    </script>
</body>
</html>
```
